<!doctype html>
<style>
  body {background-color: black;}
</style>
<canvas style="outline: 1px solid"></canvas>

<script src="https://gpac.github.io/mp4box.js/dist/mp4box.all.min.js"></script>

<script type="module">
  import {VideoRenderer} from "./video_renderer.js";

  // TODO: move to worker. Use OffscreenCanvas.
  let videoRenderer = new VideoRenderer();
  await videoRenderer.initialize('bbb_frag.mp4', document.querySelector("canvas"));

  // Wall clock rendering.
  // TODO: Implement AudioRenderer
  let startTimeMs = performance.now();
  function play() {
    let mediaTimeUs = (performance.now() - startTimeMs) * 1000;
    videoRenderer.render(mediaTimeUs)
    window.requestAnimationFrame(play);
  }
  play();
</script>

</html>

